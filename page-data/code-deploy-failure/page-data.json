{"componentChunkName":"component---src-templates-post-jsx","path":"/code-deploy-failure/","result":{"data":{"site":{"siteMetadata":{"title":"kibeom"}},"markdownRemark":{"id":"ba2ce2fa-9257-5c0d-bfc2-cf29645e2683","excerpt":"기존에 사용한 블로그에서 글을 옮겼습니다. 비슷한 내용을 발견하실 수도 있습니다. 현상 서비스에서 배치를 aws의 code deploy를 이용하여 배포와 관리하고 있습니다. 아쉽게도 code deploy에서의 이벤트 로그에 대한 모니터링은 없어 지난주부터 발생한 아래 에러를 늦게 발견한 상황이었고 배포가 제대로 이루어지지 않은 것을 알게 되었습니다.  해…","html":"<blockquote>\n<p>기존에 사용한 블로그에서 글을 옮겼습니다. 비슷한 내용을 발견하실 수도 있습니다.</p>\n</blockquote>\n<h2 id=\"현상\" style=\"position:relative;\"><a href=\"#%ED%98%84%EC%83%81\" aria-label=\"현상 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>현상</h2>\n<p>서비스에서 배치를 aws의 code deploy를 이용하여 배포와 관리하고 있습니다. 아쉽게도 code deploy에서의 이벤트 로그에 대한 모니터링은 없어 지난주부터 발생한 아래 에러를 늦게 발견한 상황이었고 배포가 제대로 이루어지지 않은 것을 알게 되었습니다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/abd425936c15c530ba833238c2e2e651/bbbf7/1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 32.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAAm0lEQVR42qWR4QrDIAyEff/H7CodWjU6bSd1vSWl22CwP044MDn5LkRlrIXWGs45lFL+Us4ZygXCMGrYeca2bd1qrWFdV6jEIOIJ27Jg3/dDvafWCiVjphgZ9Pg4X+BfQUf/fP8GOu8xDBdM0xUjT2qMReSAQMRBCXTeQwggiuylwxe9amJfdngXoDS8DxDwzB8jgCwL7tAtZzwBRuDSQARo7YsAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='1' title='' src='/static/abd425936c15c530ba833238c2e2e651/ca1dc/1.png' srcset='/static/abd425936c15c530ba833238c2e2e651/e7570/1.png 170w,\n/static/abd425936c15c530ba833238c2e2e651/f46e7/1.png 340w,\n/static/abd425936c15c530ba833238c2e2e651/ca1dc/1.png 680w,\n/static/abd425936c15c530ba833238c2e2e651/02d09/1.png 1020w,\n/static/abd425936c15c530ba833238c2e2e651/bbbf7/1.png 1280w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h2 id=\"해결\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0\" aria-label=\"해결 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>해결</h2>\n<p>메세지를 보아 agent 에 문제가 있을 수 있다는 생각을 하게 되었고 인스턴스에 ssh 접속을 통해 확인하고자 했습니다. 그 결과 아래 처럼 codedeploy agent의 상태가 비활성상태인 것을 알게 되었고 재시작시켜주었습니다. 이후 code deploy를 통해 인스턴스에 원활히 배포가 된 것을 확인할 수 있었습니다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f941b0d44b94873cc758383660abcafe/bbbf7/2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABeElEQVR42o2Sy07CYBCF21IUyqUgTYhLY6JREbmVXi1yS1gY48L3f5XxnCk0LICymP5/ms7Xc+aM4foL8aKV3AVL6fhfWrzznYt7a7aQ6jAS49UX421eXo3pJwAAhivpRWuFuXOCMgVZg0BM1FUwVhsqvHitwA5APPvJBrWVLuBtOLj5iMUsmkqUUgVVUWUvpFIoBIR2m1BJtXThjFOpjxOpAn7RPj8gkDCCWtMMjanU0Hw7SnK7ewDvVpl9Ex9bqPooVnucI61rBbk6wh2cVMzzosLH7Y887X7lPttpIyHOJJUuFDMYgl2FL6WfbjHvjRgvM6g9A3wAcPD9J8+AEnYAeFQa5CvEEVTew+sSr+DhUgnthvn6EMj0abeJmVJ5DfNk2vYwxGxj3KNzoUTFunCGtMk0qcrZKzOPAjmuk0AbQP6NCRNKq3kwS91DKnQmeSC6PpgvTwphUa2NnxZA7hstslGHDxAXnaoPe9jWvVwU6Tc06dMz/AeQ7lyH8YNuiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='2' title='' src='/static/f941b0d44b94873cc758383660abcafe/ca1dc/2.png' srcset='/static/f941b0d44b94873cc758383660abcafe/e7570/2.png 170w,\n/static/f941b0d44b94873cc758383660abcafe/f46e7/2.png 340w,\n/static/f941b0d44b94873cc758383660abcafe/ca1dc/2.png 680w,\n/static/f941b0d44b94873cc758383660abcafe/02d09/2.png 1020w,\n/static/f941b0d44b94873cc758383660abcafe/bbbf7/2.png 1280w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>실제 서비스에서 사용중인 인프라가 아니라 서비스에 영향은 없었지만 배포가 안되었을 때 바로 알아차리지 못했다는 것은 아쉬운 부분이었습니다. 이에 대한 모니터링 방법과 agent 의 상태를 추적할 수 있는지도 확인이 필요하겠습니다.</p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>참고</h2>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/codedeploy-agent-operations-verify.html\">https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/codedeploy-agent-operations-verify.html</a></p>","frontmatter":{"title":"Code deploy 는 왜 배포에 실패했을까?","date":"March 22, 2025","update":"March 22, 2025","tags":["AWS","Code deploy"],"series":null},"fields":{"slug":"/code-deploy-failure/","readingTime":{"minutes":1.735}}},"seriesList":{"edges":[{"node":{"id":"60a52a2c-f7fe-5503-9f9a-d05fda47776b","fields":{"slug":"/2025-03-18-카프카-데이터플랫폼의-최강자-ch3/"},"frontmatter":{"title":"카프카, 데이터 플랫폼의 최강자 3장"}}},{"node":{"id":"26875d4a-735a-5299-87e3-b4a53600ec6b","fields":{"slug":"/pycharm-operation-not-permitted/"},"frontmatter":{"title":"PyCharm - Operation not permitted"}}},{"node":{"id":"0104e895-f5ea-580a-8d40-329236045d50","fields":{"slug":"/code-deploy-alert/"},"frontmatter":{"title":"Code deploy에 알림을 추가하자"}}},{"node":{"id":"ba2ce2fa-9257-5c0d-bfc2-cf29645e2683","fields":{"slug":"/code-deploy-failure/"},"frontmatter":{"title":"Code deploy 는 왜 배포에 실패했을까?"}}},{"node":{"id":"a1cbf30b-c9ed-579e-a2b2-692196a521f4","fields":{"slug":"/2025-03-18-카프카-데이터플랫폼의-최강자-ch4/"},"frontmatter":{"title":"카프카, 데이터 플랫폼의 최강자 4장"}}},{"node":{"id":"b14175ad-566c-5d99-a83a-4b1ebab9351a","fields":{"slug":"/카프카-데이터플랫폼의-최강자-ch7/"},"frontmatter":{"title":"카프카, 데이터 플랫폼의 최강자 4장"}}},{"node":{"id":"7e13a133-f5da-5515-8696-225492d0be99","fields":{"slug":"/2025-04-08-카프카-데이터플랫폼의-최강자-ch5/"},"frontmatter":{"title":"카프카, 데이터 플랫폼의 최강자 5장"}}},{"node":{"id":"bd5e375b-efa3-5730-adce-e46bbc4d1307","fields":{"slug":"/2025-03-18-카프카-데이터플랫폼의-최강자-ch9/"},"frontmatter":{"title":"카프카, 데이터 플랫폼의 최강자 9장"}}},{"node":{"id":"7fa08ef7-dee3-582c-9178-7b8fda394559","fields":{"slug":"/real-mysql-8.0-1-ch5/"},"frontmatter":{"title":"Real MySQL 8.0 1권 - 05 트랜잭션과 잠금"}}},{"node":{"id":"badbe153-d90e-5c4b-ac28-b4ae09a6c8ae","fields":{"slug":"/real-mysql-8.0-1-ch4/"},"frontmatter":{"title":"Real MySQL 8.0 1권 - 04 아키텍처"}}},{"node":{"id":"ed109d56-a286-5cfa-9349-03a32320668d","fields":{"slug":"/mysql-change-pwd/"},"frontmatter":{"title":"MySQL 8.0 계정의 비밀번호 변경하기"}}},{"node":{"id":"a5cd5895-3ede-586b-8955-0fa0082ca19c","fields":{"slug":"/postman-config/"},"frontmatter":{"title":"postman 환경 변수 사용하기"}}},{"node":{"id":"b9b7a5b2-905a-50ce-9ca7-d0ee132aa555","fields":{"slug":"/sqlalchemy-connection-pool-not-available/"},"frontmatter":{"title":"SQLAlchemy connection pool 설정을 통한 MySQL Connection not available 회피하기"}}},{"node":{"id":"6f147fa2-3aef-5867-92ea-c9209172a1da","fields":{"slug":"/Trie/"},"frontmatter":{"title":"자료구조 - Trie"}}},{"node":{"id":"8c781474-acd9-5314-983c-ad0ff7d4adbc","fields":{"slug":"/2025-05-05-개발자를-위한-레디스-ch1/"},"frontmatter":{"title":"개발자를 위한 레디스 1장"}}},{"node":{"id":"43843900-7613-5d1b-b8eb-cbdcde4f61ce","fields":{"slug":"/2025-05-06-개발자를-위한-레디스-ch3/"},"frontmatter":{"title":"개발자를 위한 레디스 3장"}}},{"node":{"id":"78a85471-28fe-5388-8ad1-81c1bd5a82db","fields":{"slug":"/2025-05-10-개발자를-위한-레디스-ch4/"},"frontmatter":{"title":"개발자를 위한 레디스 4장"}}},{"node":{"id":"faa8518f-86c1-55ac-bbf8-351dc302f7c1","fields":{"slug":"/about/"},"frontmatter":{"title":"This is about page ✋"}}}]},"previous":{"fields":{"slug":"/code-deploy-alert/"},"frontmatter":{"title":"Code deploy에 알림을 추가하자"}},"next":{"fields":{"slug":"/mysql-change-pwd/"},"frontmatter":{"title":"MySQL 8.0 계정의 비밀번호 변경하기"}}},"pageContext":{"id":"ba2ce2fa-9257-5c0d-bfc2-cf29645e2683","series":null,"previousPostId":"0104e895-f5ea-580a-8d40-329236045d50","nextPostId":"ed109d56-a286-5cfa-9349-03a32320668d"}},"staticQueryHashes":[],"slicesMap":{}}