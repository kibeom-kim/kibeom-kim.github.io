---
title: 개발자를 위한 레디스 1장
date: 2025-05-05
update: 2025-05-05
tags: 
	- redis
---

# 마이크로 서비스 아키텍쳐와 레디스

## 모놀리틱 아키텍쳐
- 전통적인 소프트웨어 개발 모델로 전체 애플리케이션을 하나의 통합된 패키지로 개발, 배포
- 작은 규모의 서비스에서는 운영하기 쉬울 수 있음
- 서비스 규모가 확장되면 유지보수의 복잡도가 증가
- 하나의 모듈 수정에도 전체를 다시 배포해야 함 -> 업데이트와 릴리스가 느려짐
## 마이크로서비스 아키텍쳐
- 독립된 각각의 모듈을 조립해 하나의 서비스로 만듬
- 각 서비스 별로 다른 개발 도구 선택 및 개별적인 확장이 가능
- 대규모 인원이 튜입될 수 있을 때는 장점을 누릴 수 있지만 소규모 팀에는 운영 부담이 증가

## 요구사항의 변경
- 모놀리틱에서는 관계형 데이터베이스가 많이 사용됨
- 애플리케이션이 커질수록 관계간의 복잡성으로 인한 쿼리의 성능 문제가 발생
- 쿼리, 인덱스, 테이블 구조에 자주 최적화 필요

```p
관계형 데이터베이스의 특징 ACID 
Atomicity 원자성 : 트랜잭션이 완벽하게 실행되거나 아예 실행되지 않음
Consistency 일관성 : 트랜잭션은 실행 전후로도 제약 조건을 만족
Isolation 독립성 : 트랜잭션 실행 시 다른 트랜잭션의 개입이 없음
Durablility 지속성 : 성공적으로 수행된 트랜잭션은 영원히 반영됨
```

- 최근에는 정해진 형태가 없고, 크기와 구조를 예측할 수 없는 비정형 데이터가 증가
- 다차원이거나 깊은 계층 구조를 가질 수 있어 관계형 데이터베이스에서는 관리하기가 어려움 -> NoSQL의 필요성

# NoSQL이란
- No SQL 또는 Not Only SQL
- 관계형 데이터베이스에서 쿼리하기 위한 SQL을 사용하지 않는 데이터 저장소
## 특징
- 실시간응답
	- 100ms를 넘어가면 지연이 있다고 인지한다고 함
	- 데이터 저장소에서 가져올 대는 지연이 0~1 ms이내여야 함
- 확장성
- 고가용성
- 클라우드 네이티브
- 단순성

## NoSQL 데이터 저장소 유형
- 그래프
	- 관계를 저장하고 표현할 때 유용하게 사용
	- 추천 서비스에서 유용
- 칼럼
	- 분석, 보고, 빅데이터 처리에 적합.  ex. Apache Cassandra, HBase
	- 칼럼 유형은 행이 아닌 열을 기준으로 저장
- 문서
	- Json 형태. 계층 트리 구조. 데이터 저장 또는 검색에 용이
	- 스키마가 정해져 있지 않아 유연성이 큼
		- ex. MongoDb, CouchDb, AWS Document DB
- 키-값
	-  가장 단순하고 빠름
	- 키를 삭제하면 값도 삭제됨
	- 데이터 저장이 간편하여 다른 유형보다 수평적 확장에 용이
		- ex. AWS ElastiCache, DynamoDB, Oracle NoSQL Database, Memcached

## 레디스 Redis
- Remote dictionary server
- 고성능 키-값 유형의 인메모리 NoSQL 데이터 베이스
- 레디스의 특징
	- 실시간 응답
		- 대부분은 온디스크
			- 디스크의 데이터를 페이지 단위로 메모리에 올려 데이터를 찾고 없는 경우 다른 페이지를 가져와 메모리에 올린 뒤 찾는 과정 반복
		- 인메모리는 모든 데이터가 메모리에 존재하여 디스크에 접근하는 과정이 없기 때문에 처리 성능이 빠름
	- 단순성
		- 레디스는 싱글 스레드로 동작
			- 메인 스레드 1개, 별도의 스레드 3개 총 4개이지만, 클라이언트 커맨드는 이벤트 루프를 이용한 싱글 스레드로 동작
			- cpu가 적은 서버에서도 좋은 성능
			- 도익화나 잠금 매커니즘 없이도 안정적이고 빠르게 요청 처리 가능
		- 반환이 느린 특정한 커맨드가 존재하니 유의해서 사용. (ex. KEYS)
	- 고가용성
		- 레디스는 자체적으로 HA기능 제공
			- 복제를 통해 데이터를 여러 서버에 분산
			- 센티널은 장애 상황을 탐지해 자동으로 fail over
	- 확장성
		- 클러스터 모드를 사용하면 손쉬운 수평적 확장이 가능
		- 데이터의 분리는 데이터베이스 레이어에서 처리하므로 어플리케이션에서는 신경쓰지 않아도 됨
		- 또한 클러스터 모드를 사용하면 자동으로 레디스에서 클러스터 버스라는 프로토콜을 이용해 서로 감시하며 자동으로 fail over 진행
	- 클라우드 네이티브 -멀티 클라우드
		- 멀티 클라우드는 여러 클라우드 업체의 서비스를 동시에 혹은 혼합해 활용하는 전략

## 마이크로 서비스와 레디스

### 데이터 저장소서의 레디스
- msa에서 각 서비스 별 개별 저장소로 사용하기에 알맞음
	- 설치가 간편
	- 최소한의 리소스로 막대한 처리량
	- 다양한 자료구조를 제공하면서 사용이 간단
- 데이터 영속성을 위해 AOF 와 RDB 형식으로 디스크에 주기적으로 저장할 수 있음
- 백업 파일을 이용하여 다시 복구할 수 있음

### 메시지 브로커로서의 레디스
- msa에서 서로 다른 서비스 간에 지속적인 통신이 필요
- 비동기적으로 데이터를 전달할 수 있는 통신 채널을 구현하는 것이 좋음
- pub/sub기능
	- 가장 간단한 메시징 기능으로 빠르고 동작하고 간단하게 사용가능
	- 모든 상황에 적합하지는 않지만 fire-and-forget 패턴이 필요한 간단한 알림에서는 유용
	- list자료 구조를 활용하여 push/pop
- stream자료 구조
	- 완벽한 스트림 플랫폼으로 사용 가능
	- 아파치 카프카 시슽메에서 영감을 받아 만등러진 자료 구조로 데이터는 계속해서 추가되는 방식으로 저장 (append-only)
	- 소비자와 소비자 그룹이 존재해 데이터 분산 처리 가능
	- 저장된 데이터를 시간대별로 검색하는 것도 가능
